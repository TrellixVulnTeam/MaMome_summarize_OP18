8_PARAGRAPHS

For taxa with greater than ﬁve sequences assigned, the standard two-popula-
tion proportions test is used to estimate the probability of the observed differ-
ences (7). The P value is estimated from the Z critical value, where y N (cid:3) x N (cid:3) 2 1 N (cid:4) N1 1 (cid:1)(cid:6)(cid:7)1 (cid:3) (cid:6)(cid:8)(cid:2) 1 2 Z (cid:2) and where N1 and N2 are the total number of sequences for library 1 and 2,
respectively, x and y are the number of sequences assigned to taxon T from
library 1 and 2, respectively, and (cid:6) equals (x (cid:1) y)/(N1 (cid:1) N2).

SeqMatch k-NN classiﬁer. The RDP SeqMatch tool is a k-nearest-neighbor
(k-NN) classiﬁer (8). It uses a word-matching strategy not requiring alignment to
determine the percentage of shared seven-character words between a query and
members of a database of sequences. This tool assigns queries to the lowest taxon
shared by the highest-scoring k database sequences. For the tests described here,
the Bergey corpus was used as the database, and a query was assigned to the
same genus as the closest-matching sequence from the Bergey corpus (effec-
tively, k (cid:2) 1). Setting k to 1 ensured that all queries were classiﬁed at all
taxonomic ranks for comparison with the RDP Classiﬁer.

The online version of Library Compare is available at http://rdp.cme.msu.edu
/comparison. A user can upload two ﬁles containing sequences from two librar-
ies. After the sequences are classiﬁed, the statistical comparison analysis is MATERIALS AND METHODS Type sequences with Bergey’s taxonomy. Small-subunit rRNA sequences con-
sisting of 5,014 bacterial species type strain sequences in 988 genera (Table 1),
along with associated taxonomic assignment information, were obtained from
Bergey’s Taxonomic Outline of the Prokaryotes (release 5.0 [2004]) (13). The
sequences averaged 1,460 bases in length and had a range of 1,200 to 1,833 bases.
These sequences formed the Bergey corpus. Each sequence was labeled with
a set of taxa from domain to genus. From the highest rank to the lowest, the
major formal taxonomic ranks are domain, phylum, class, order, family,
genus, and species. There are occasional intermediate ranks such as “sub-
class” and “suborder”.

Algorithm. The Classiﬁer uses a feature space consisting of all possible 8-base
subsequences (words). Word sizes between 6 and 9 bases were tested in prelim-
inary experiments. Sizes of 8 and 9 bases gave nearly identical results, while sizes
of 6 and 7 bases were less accurate, especially with shorter test sequences (not
shown). As there are fewer possible words of size 8 than size 9, size 8 was chosen
for all further work to reduce memory requirements. The position of a word in
a sequence is ignored. As with text-based Bayesian classiﬁers, only those words
occurring in the query contribute to the score (16). A similar word-based clas-
siﬁcation scheme has been used to search for horizontal gene transfer events in
whole-genome sequences (21).

Word-speciﬁc priors. Let W (cid:2) {w1, w2, . . ., wd} be the set of all possible
eight-character subsequences (words). From the corpus consisting of N se-
quences, let n(wi) be the number of sequences containing subsequence wi. The
expected-likelihood estimate (determined with the Jeffreys-Perks law of succes-
(cid:2) [n(wi) (cid:1)
sion) calculated for each word over the entire corpus with the formula Pi
0.5]/(N (cid:1) 1) was used as a word-speciﬁc prior estimate of the likelihood of
observing word wi in an rRNA sequence. The values 0.5 in the numerator and 1
in the denominator keep the probabilities in the range 0 (cid:3) Pi (cid:3) 1.

Using the RDP 9 alignment (8), we extracted segments cor-
responding to 100-base regions of the Escherichia coli refer-
ence sequence J01695 at 25-base intervals and used each re-
gion independently for exhaustive leave-one-out
testing,
removing the corresponding full-length sequence from training
for each test. In general, accuracy was greater for regions
mapping to the 16S hypervariable regions (Fig. 2A). The av-
erage bootstrap conﬁdence estimate was similarly higher in the
hypervariable regions (Fig. 2B).

VOL. 73, 2007 THE RDP CLASSIFIER 5265 crepancies between the underlying (16S rRNA) phylogeny and
Bergey’s taxonomy. Over 60% of misclassiﬁed sequences were
actually more similar to sequences in other genera than to
sequences in their own genera, strong evidence that these
genera may not be monophyletic. These misclassiﬁcations are
not evenly distributed among the taxa. Of the three most rep-
resented phyla (Firmicutes, Proteobacteria, and Actinobacteria),
the Actinobacteria had the fewest errors (3%, or 31 in 1,220
trials), while the misclassiﬁcation rate for the Firmicutes was
about ﬁve times as high (13%, or 165 in 1,295 trials). Within
the Firmicutes, more than two-thirds of the errors occurred in
the class Clostridia (108 of 449 trials), and within that class, the
genus Eubacterium stood out, with 30 misclassiﬁcations in 41
trials (see the supplemental material).

Pyrosequencing can now produce up to 100 Mb in less than
8 h (Roche product literature). Sogin and colleagues recently
used the ﬁrst version of pyrosequencing, which provided up-
to-100-bp reads, to rapidly analyze large numbers of 16S rRNA
V6 variable regions from environmental samples (23). In that
study, taxonomic diversity was assessed through alignment to
members of a reference database of vetted V6 sequences. The
classiﬁcation accuracy of the RDP Classiﬁer for 100-base frag-
ments varied greatly by region along the 16S rRNA molecule
(Fig. 2). Variable regions were, in general, more accurately TABLE 5. Classiﬁer accuracy at various query
lengths (NCBI’s taxonomy) % of segments accurately identiﬁed in: Phylum Class Order Family Genus 99.8
99.7
99.7
99.2
94.6 99.3
99.3
99.2
98.4
90.9 98.6
98.5
98.1
95.7
81.6 97.1
97.0
95.7
88.9
69.2 92.1
90.4
86.6
74.9
52.8 Length of
segment
(bases) Full
400
200
100
50 FIG. 3. Phylogenetic analysis of the Alicyclobacillaceae, including
the genera Sulfobacillus and Alicyclobacillus. Sequences for each of the
11 species type strains of Alicyclobacillaceae available in release 5.0 of
Bergey’s taxonomic outline, along with additional sequences for four
Alicyclobacillaceae species type strains that became available after the
release of the outline (marked with an asterisk), and two Bacillus
species type strains were analyzed using the weighted neighbor-joining
method (5). The tree is rooted using Escherichia coli sequence J01695
as the outgroup. Bootstrap conﬁdence estimates above 85% are
shown. Three misclassiﬁcations made by the RDP Classiﬁer are high-
lighted, with the original (release 5.0) description appended with a
corrected description. S. disulﬁdooxidansT became A. disulﬁdooxi-
dansT. In 2005, S. disulﬁdooxidans was formally reclassiﬁed as a new
combination, A. disulﬁdooxidans (14). S. thermosulﬁdooxidans VKM
1269T became “A. tolerans K1.” In release 5, sequence Z21979 was
listed as coming from the type strain (VKM 1269) of S. thermosulﬁ-
dooxidans. This agrees with the original publication for the sequence
(25). The same group later reported that the sequence was probably
from S. thermosulﬁdooxidans strain K1, not VKM 1269 (15). Two
independent sequences (X91080 and AB089844) for the type strain of
S. thermosulﬁdooxidans are available. They are nearly identical to each
other (0.2% difference) and 19% different from Z21979. In 2005, S.
thermosulﬁdooxidans strain K1 was reclassiﬁed as the type strain of a
new species, A. tolerans (14). In our analysis, however, the sequence for
K1 given in the naming paper (accession number AF137502) is 8%
different from that for Z21979. Although still listed in the GenBank
record as from A. tolerans strain K1, Z21979 is most probably not from
strain K1 and not even from a member of the species A. tolerans. A.
acidoterrestrisT became Bacillus sp. Sequence X60602 was published
in 1991 as from the type strain (DSM 3922) for A. acidoterrestris (1).
The GenBank record also lists this as from strain DSM 3922, but a
strain mix-up in the culture supplied by the DSMZ was reported in
1992 (27). The type strain (ATCC 49025, listed by the DSMZ as
equivalent to DSM 3922) was resequenced in 2005 (AY573797 [9]).
These two sequences are 14% different, and X60602 is now de-
scribed by GenBank as from a Bacillus sp